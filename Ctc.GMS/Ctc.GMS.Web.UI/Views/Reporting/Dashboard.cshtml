@model ReportingDashboardViewModel

@{
    ViewData["Title"] = "CTC Internal Reporting";
}

@section Breadcrumbs {
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="@Url.Action("Dashboard", "GrantsTeam")">Grants Team</a></li>
        <li class="breadcrumb-item active">Reporting</li>
    </ol>
}

<div class="page-header">
    <h2><i class="mdi mdi-file-chart-outline"></i> CTC Internal Reporting</h2>
    <p class="subtitle">Generate custom reports for internal stakeholders</p>
</div>

@* QUICK ACCESS REPORTS *@
<div class="r4-card">
    <div class="r4-card-header">
        <h4><i class="mdi mdi-lightning-bolt-outline"></i> Quick Access Reports</h4>
        <p class="card-subtitle">Frequently used report templates</p>
    </div>
    <div class="r4-card-body">
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem;">
            <div style="display: flex; gap: 1rem; padding: 1.5rem; border: 1px solid var(--gray-300); border-radius: 8px; background-color: var(--white); transition: box-shadow 0.2s;">
                <div style="font-size: 3rem; color: var(--ctc-blue);">
                    <i class="mdi mdi-account-group"></i>
                </div>
                <div style="flex: 1;">
                    <h5 style="margin: 0 0 0.5rem 0; color: var(--ctc-blue);">Current Demographics</h5>
                    <p style="margin: 0 0 1rem 0; color: var(--gray-600); font-size: 0.875rem;">Student demographics for current grant cycle</p>
                    <a href="@Url.Action("GenerateReport", "Reporting", new { type = "demographic", cycle = "current" })" class="r4-button r4-button-sm r4-button-primary">
                        <i class="mdi mdi-download"></i> Generate
                    </a>
                </div>
            </div>

            <div style="display: flex; gap: 1rem; padding: 1.5rem; border: 1px solid var(--gray-300); border-radius: 8px; background-color: var(--white); transition: box-shadow 0.2s;">
                <div style="font-size: 3rem; color: var(--ctc-blue);">
                    <i class="mdi mdi-domain"></i>
                </div>
                <div style="flex: 1;">
                    <h5 style="margin: 0 0 0.5rem 0; color: var(--ctc-blue);">LEA Performance</h5>
                    <p style="margin: 0 0 1rem 0; color: var(--gray-600); font-size: 0.875rem;">Summary of all LEA participation and outcomes</p>
                    <a href="@Url.Action("GenerateReport", "Reporting", new { type = "lea-summary", cycle = "current" })" class="r4-button r4-button-sm r4-button-primary">
                        <i class="mdi mdi-download"></i> Generate
                    </a>
                </div>
            </div>

            <div style="display: flex; gap: 1rem; padding: 1.5rem; border: 1px solid var(--gray-300); border-radius: 8px; background-color: var(--white); transition: box-shadow 0.2s;">
                <div style="font-size: 3rem; color: var(--ctc-blue);">
                    <i class="mdi mdi-currency-usd"></i>
                </div>
                <div style="flex: 1;">
                    <h5 style="margin: 0 0 0.5rem 0; color: var(--ctc-blue);">Financial Summary</h5>
                    <p style="margin: 0 0 1rem 0; color: var(--gray-600); font-size: 0.875rem;">Budget utilization and disbursement tracking</p>
                    <a href="@Url.Action("GenerateReport", "Reporting", new { type = "financial", cycle = "current" })" class="r4-button r4-button-sm r4-button-primary">
                        <i class="mdi mdi-download"></i> Generate
                    </a>
                </div>
            </div>

            <div style="display: flex; gap: 1rem; padding: 1.5rem; border: 1px solid var(--gray-300); border-radius: 8px; background-color: var(--white); transition: box-shadow 0.2s;">
                <div style="font-size: 3rem; color: var(--ctc-blue);">
                    <i class="mdi mdi-chart-line"></i>
                </div>
                <div style="flex: 1;">
                    <h5 style="margin: 0 0 0.5rem 0; color: var(--ctc-blue);">Program Outcomes</h5>
                    <p style="margin: 0 0 1rem 0; color: var(--gray-600); font-size: 0.875rem;">Credential areas, completion rates, and impact</p>
                    <a href="@Url.Action("GenerateReport", "Reporting", new { type = "outcomes", cycle = "current" })" class="r4-button r4-button-sm r4-button-primary">
                        <i class="mdi mdi-download"></i> Generate
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

@* REPORT BUILDER *@
<div class="r4-card">
    <div class="r4-card-header">
        <h4><i class="mdi mdi-cog-outline"></i> Custom Report Builder</h4>
        <p class="card-subtitle">Create customized reports based on your specific needs</p>
    </div>
    <div class="r4-card-body">
        <form id="reportBuilderForm" method="post" action="@Url.Action("GenerateReport", "Reporting")">
            <div class="form-section" style="margin-bottom: 1.5rem;">
                <h5 style="margin-bottom: 1rem;"><i class="mdi mdi-format-list-bulleted"></i> Report Type</h5>
                <div style="display: grid; grid-template-columns: 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label for="reportType" style="font-weight: 600; margin-bottom: 0.5rem; display: block;">Select Report Category</label>
                        <select id="reportType" name="reportType" class="form-control" style="width: 100%; padding: 0.5rem;">
                            <option value="">-- Choose a report type --</option>
                            <option value="demographic">Demographics Report</option>
                            <option value="lea-summary">LEA Summary Report</option>
                            <option value="ihe-summary">IHE Summary Report</option>
                            <option value="financial">Financial Summary Report</option>
                            <option value="program-outcomes">Program Outcomes Report</option>
                            <option value="compliance">Compliance & Reporting Status</option>
                            <option value="custom">Custom Query Report</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-section" style="margin-bottom: 1.5rem;">
                <h5 style="margin-bottom: 1rem;"><i class="mdi mdi-filter-outline"></i> Filters & Parameters</h5>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                    <div class="form-group">
                        <label for="grantCycle">Grant Cycle</label>
                        <select id="grantCycle" name="grantCycle" class="form-control">
                            <option value="current">Current Cycle (FY 2025-26)</option>
                            <option value="previous">Previous Cycle (FY 2024-25)</option>
                            <option value="all">All Cycles</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="dateRange">Date Range</label>
                        <select id="dateRange" name="dateRange" class="form-control">
                            <option value="all">All Time</option>
                            <option value="ytd">Year to Date</option>
                            <option value="last30">Last 30 Days</option>
                            <option value="last90">Last 90 Days</option>
                            <option value="custom">Custom Range...</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="organization">Organization Filter</label>
                        <select id="organization" name="organization" class="form-control">
                            <option value="all">All Organizations</option>
                            <option value="lea">LEAs Only</option>
                            <option value="ihe">IHEs Only</option>
                            <option value="specific">Specific Organization...</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="status">Status Filter</label>
                        <select id="status" name="status" class="form-control">
                            <option value="all">All Statuses</option>
                            <option value="approved">Approved Only</option>
                            <option value="pending">Pending Review</option>
                            <option value="completed">Completed</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="form-section" style="margin-bottom: 1.5rem;">
                <h5 style="margin-bottom: 1rem;"><i class="mdi mdi-table-column"></i> Data Fields to Include</h5>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.75rem;">
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="includeStudentInfo" name="includeStudentInfo" checked>
                        <label class="form-check-label" for="includeStudentInfo">Student Information</label>
                    </div>
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="includeDemographics" name="includeDemographics" checked>
                        <label class="form-check-label" for="includeDemographics">Demographics</label>
                    </div>
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="includeFinancial" name="includeFinancial" checked>
                        <label class="form-check-label" for="includeFinancial">Financial Data</label>
                    </div>
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="includeCredentials" name="includeCredentials" checked>
                        <label class="form-check-label" for="includeCredentials">Credential Areas</label>
                    </div>
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="includePartnership" name="includePartnership">
                        <label class="form-check-label" for="includePartnership">Partnership Details</label>
                    </div>
                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="includeCompliance" name="includeCompliance">
                        <label class="form-check-label" for="includeCompliance">Compliance Data</label>
                    </div>
                </div>
            </div>

            <div class="form-section" style="margin-bottom: 1.5rem;">
                <h5 style="margin-bottom: 1rem;"><i class="mdi mdi-file-download-outline"></i> Output Format</h5>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                    <div class="form-group">
                        <label for="outputFormat">Export Format</label>
                        <select id="outputFormat" name="outputFormat" class="form-control">
                            <option value="pdf">PDF Document</option>
                            <option value="excel">Excel Spreadsheet (.xlsx)</option>
                            <option value="csv">CSV File</option>
                            <option value="preview">Preview in Browser</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="reportName">Report Name (Optional)</label>
                        <input type="text" id="reportName" name="reportName" class="form-control" placeholder="e.g., Q1 Demographics Report">
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" class="r4-button r4-button-primary">
                    <i class="mdi mdi-file-chart"></i> Generate Report
                </button>
                <button type="button" class="r4-button r4-button-secondary" onclick="document.getElementById('reportBuilderForm').reset();">
                    <i class="mdi mdi-refresh"></i> Reset Form
                </button>
            </div>
        </form>
    </div>
</div>

@* RECENT REPORTS *@
<div class="r4-card">
    <div class="r4-card-header">
        <h4><i class="mdi mdi-history"></i> Recently Generated Reports</h4>
    </div>
    <div class="r4-card-body">
        <div class="alert alert-info">
            <i class="mdi mdi-information-outline"></i>
            <strong>Report History:</strong> Your recently generated reports will appear here for quick access. (Coming soon in future release)
        </div>
    </div>
</div>

@* NATURAL LANGUAGE QUERY - FUTURE ENHANCEMENT *@
<div class="r4-card">
    <div class="r4-card-header">
        <h4><i class="mdi mdi-robot-outline"></i> Natural Language Query <span class="badge">Coming Soon</span></h4>
    </div>
    <div class="r4-card-body">
        <p class="text-muted">Ask questions in plain English and get instant custom reports. This AI-powered feature will be available in version 2.0.</p>

        <div class="form-group">
            <label for="nlQuery">
                <i class="mdi mdi-message-text-outline"></i> Enter your question
            </label>
            <textarea id="nlQuery"
                      class="form-control"
                      rows="3"
                      disabled
                      placeholder="Example: Show me all students from Los Angeles who received funding in the last quarter"></textarea>
        </div>

        <button type="button" class="r4-button r4-button-primary" disabled>
            <i class="mdi mdi-sparkles"></i> Generate Report
        </button>
    </div>
</div>

@section Scripts {
    <script>
        document.getElementById('reportBuilderForm').addEventListener('submit', function(e) {
            // Form validation could go here
            const reportType = document.getElementById('reportType').value;
            if (!reportType) {
                e.preventDefault();
                alert('Please select a report type before generating.');
                return false;
            }
        });
    </script>
}
